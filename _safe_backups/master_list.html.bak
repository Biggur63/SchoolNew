{{/*
Shortcode: masters_list
Usage (одна карточка):
  {{< masters_list 
      title="Имя" 
      description="Описание" 
      image="/img.jpg" 
      url="/page/" 
  >}}

Usage (список мастеров):
  {{< masters_list list="
    [
      { 
        \"title\": \"Имя 1\", 
        \"description\": \"Описание 1\", 
        \"image\": \"/img1.jpg\", 
        \"url\": \"/page1/\" 
      },
      { 
        \"title\": \"Имя 2\", 
        \"description\": \"Описание 2\", 
        \"image\": \"/img2.jpg\", 
        \"url\": \"/page2/\" 
      }
    ]
  " >}}
*/}}

{{/* Получаем список */}}
{{ $list := .Get "list" }}

{{ if $list }}

  {{/* Используем transform.Unmarshal — современный аналог fromJson */}}
  {{ $items := transform.Unmarshal $list }}

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
    {{ range $items }}
      <div class="bg-white rounded-2xl shadow p-6 transition hover:-translate-y-1 hover:shadow-lg">

        {{ if .url }}
          <a href="{{ .url }}" class="block">
        {{ end }}

        {{ if .image }}
          <img class="w-full h-48 object-cover rounded-xl mb-4" src="{{ .image }}" alt="{{ .title }}">
        {{ end }}

        {{ if .title }}
          <h3 class="text-xl font-semibold mb-2">{{ .title }}</h3>
        {{ end }}

        {{ if .description }}
          <div class="prose max-w-none text-gray-700">
            {{ .description | markdownify }}
          </div>
        {{ end }}

        {{ if .url }}
          </a>
        {{ end }}

      </div>
    {{ end }}
  </div>

{{ else }}

  {{/* Режим одиночной карточки */}}

  <div class="bg-white rounded-2xl shadow p-6 transition hover:-translate-y-1 hover:shadow-lg max-w-md">

    {{ with .Get "url" }}<a href="{{ . }}" class="block">{{ end }}

    {{ with .Get "image" }}
      <img class="w-full h-48 object-cover rounded-xl mb-4" src="{{ . }}" alt="{{ $.Get "title" }}">
    {{ end }}

    {{ with .Get "title" }}
      <h3 class="text-xl font-semibold mb-2">{{ . }}</h3>
    {{ end }}

    {{ with .Get "description" }}
      <div class="prose max-w-none text-gray-700">
        {{ . | markdownify }}
      </div>
    {{ end }}

    {{ if .Get "url" }}</a>{{ end }}

  </div>

{{ end }}
